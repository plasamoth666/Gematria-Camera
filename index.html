<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gematria Vision Camera</title><!-- PWA Configuration -->
  <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIkdlbWF0cmlhIFZpc2lvbiBDYW1lcmEiLAogICJzaG9ydF9uYW1lIjogIkdlbWF0cmlhIiwKICAiZGVzY3JpcHRpb24iOiAiVHJhbnNmb3JtIHJlYWxpdHkgdGhyb3VnaCBzYWNyZWQgbnVtZXJvbG9neSIsCiAgInN0YXJ0X3VybCI6ICIuLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiIzY2N2VlYSIsCiAgInRoZW1lX2NvbG9yIjogIiM2NjdlZWEiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlNVGt5SWlCb1pXbG5hSFE5SWpFNU1pSWdkbWxsZDBKdmVEMGlNQ0F3SURFNU1pQXhPVElpSUdacGJHdzlJbTV2Ym1VaUlIaHRiRzV6UFNKb2RIUndPaTh2ZDNkM0xuY3pMbTl5Wnk4eU1EQXdMM04yWnlJK1BISmxZM1FnZDJsa2RHZzlJakU1TWlJZ2FHVnBaMmgwUFNJeE9USWlJSEo0UFNJeU5DSWdabWxzYkQwaWRYSnNLQ05uY21Ga2FXVnVkREJmYkdsdVpXRnlYekZmTVNraUx6NEtQR1JsWm5NK1BHeHBibVZoY2tkeVlXUnBaVzUwSUdsa1BTSm5jbUZrYVdWdWREQmZiR2x1WldGeVh6RmZNU0lnZURFOUlqQWlJSGt4UFNJd0lpQjRNajBpTVRreUlpQjVNajBpTVRreUlpQm5jbUZrYVdWdWRGVnVhWFJ6UFNKMWMyVnlVM0JoWTJWUGJsVnpaU0krUEhOMGIzQWdjM1J2Y0MxamIyeHZjajBpSXpZMk4yVmxZU0l2UGp4emRHOXdJRzltWm5ObGREMGlNU0lnYzNSdmNDMWpiMnh2Y2owaUl6YzJOR0poTWlJdlBqd3ZiR2x1WldGeVIzSmhaR2xsYm5RK1BDOWtaV1p6UGp3dmMzWm5QZz09IiwKICAgICAgInNpemVzIjogIjE5MngxOTIiLAogICAgICAidHlwZSI6ICJpbWFnZS9zdmcreG1sIgogICAgfQogIF0sCiAgImNhdGVnb3JpZXMiOiBbInBob3RvZ3JhcGh5IiwgInV0aWxpdGllcyJdCn0=">
  <meta name="theme-color" content="#667eea">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Gematria Vision">
  <style>
        body {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100%;
            color: #333;
            overflow-x: hidden;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .app-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }

        .subtitle {
            color: rgba(255,255,255,0.9);
            font-size: 1.1rem;
        }

        .camera-section {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 25px;
        }

        .cipher-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .cipher-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
        }

        .cipher-btn.active {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .camera-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto 20px;
            border-radius: 15px;
            overflow: hidden;
            background: #f0f0f0;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #videoElement {
            width: 100%;
            height: 300px;
            object-fit: cover;
            display: none;
        }

        #videoElement.active {
            display: block;
        }

        .camera-placeholder {
            text-align: center;
            color: #666;
            padding: 40px;
        }

        .camera-placeholder.hidden {
            display: none;
        }

        #canvas {
            display: none;
        }

        .camera-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .control-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
            min-width: 120px;
        }

        .control-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .capture-btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
        }

        .capture-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .start-camera-btn {
            background: linear-gradient(45deg, #4ecdc4, #44a08d);
            color: white;
        }

        .start-camera-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .start-camera-btn.active {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
        }

        .demo-btn {
            background: linear-gradient(45deg, #9b59b6, #8e44ad);
            color: white;
        }

        .demo-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }

        .analysis-section {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            margin-bottom: 25px;
            display: none;
        }

        .analysis-title {
            font-size: 1.8rem;
            font-weight: bold;
            color: #667eea;
            margin-bottom: 20px;
            text-align: center;
        }

        .detected-objects {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .object-card {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .object-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }

        .gematria-value {
            font-size: 1.3rem;
            font-weight: bold;
            margin: 5px 0;
        }

        .transformation {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .result-images {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .image-container {
            flex: 1;
            min-width: 200px;
            text-align: center;
        }

        .image-label {
            font-weight: bold;
            margin-bottom: 10px;
            color: #667eea;
        }

        .result-image {
            width: 100%;
            max-width: 250px;
            height: 200px;
            object-fit: cover;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #ff6b6b;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }

        .success-message {
            background: #2ecc71;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }

        .info-message {
            background: #3498db;
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            text-align: center;
        }

        .camera-status {
            text-align: center;
            margin: 10px 0;
            font-weight: 600;
        }

        .install-prompt {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .install-btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
        }

        @media (max-width: 600px) {
            .container {
                padding: 15px;
            }
            
            .app-title {
                font-size: 2rem;
            }
            
            .cipher-selector {
                flex-direction: column;
            }
            
            .result-images {
                flex-direction: column;
            }

            .camera-controls {
                flex-direction: column;
                align-items: center;
            }

            .control-btn {
                width: 100%;
                max-width: 250px;
            }
        }

        /* Fullscreen camera mode */
        .fullscreen-camera {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: black;
            z-index: 1000;
            display: none;
            flex-direction: column;
        }

        .fullscreen-camera.active {
            display: flex;
        }

        .fullscreen-video {
            flex: 1;
            width: 100%;
            object-fit: cover;
        }

        .fullscreen-controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            gap: 20px;
        }

        .fullscreen-btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .capture-fullscreen {
            background: #ff6b6b;
            color: white;
        }

        .close-fullscreen {
            background: rgba(255,255,255,0.8);
            color: #333;
        }
    </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
  <script src="/_sdk/element_sdk.js" type="text/javascript"></script>
  <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
 </head>
 <body>
  <div class="container">
   <div class="header">
    <h1 class="app-title">Gematria Vision Camera</h1>
    <p class="subtitle">Transform reality through sacred numerology</p>
   </div><!-- Install prompt for PWA -->
   <div class="install-prompt" id="installPrompt" style="display: none;">
    <h3>📱 Install Gematria Vision</h3>
    <p>Install this app on your device for the best camera experience!</p><button class="install-btn" id="installBtn">Install App</button>
   </div>
   <div class="camera-section">
    <div class="cipher-selector"><button class="cipher-btn active" data-cipher="hebrew">Hebrew Gematria</button> <button class="cipher-btn" data-cipher="english">English Gematria</button> <button class="cipher-btn" data-cipher="simple">Simple Gematria</button>
    </div>
    <div class="camera-container">
     <video id="videoElement" autoplay playsinline muted></video>
     <div class="camera-placeholder" id="cameraPlaceholder">
      <h3>📷 Camera Ready</h3>
      <p>Click "Start Camera" to begin capturing</p>
     </div>
     <canvas id="canvas"></canvas>
    </div>
    <div class="camera-status" id="cameraStatus"></div>
    <div class="camera-controls"><button class="control-btn start-camera-btn" id="startCamera">Start Camera</button> <button class="control-btn capture-btn" id="captureBtn" disabled>Capture &amp; Transform</button> <button class="control-btn demo-btn" id="demoBtn">Try Demo Mode</button>
    </div>
   </div>
   <div class="analysis-section" id="analysisSection">
    <h2 class="analysis-title">Gematria Analysis</h2>
    <div id="analysisContent"></div>
   </div>
  </div><!-- Fullscreen camera mode -->
  <div class="fullscreen-camera" id="fullscreenCamera">
   <video id="fullscreenVideo" class="fullscreen-video" autoplay playsinline muted></video>
   <div class="fullscreen-controls"><button class="fullscreen-btn capture-fullscreen" id="captureFullscreen">📷</button> <button class="fullscreen-btn close-fullscreen" id="closeFullscreen">✕</button>
   </div>
  </div>
  <script>
        // PWA Installation
        let deferredPrompt;
        const installPrompt = document.getElementById('installPrompt');
        const installBtn = document.getElementById('installBtn');

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installPrompt.style.display = 'block';
        });

        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                installPrompt.style.display = 'none';
            }
        });

        // Gematria calculation systems
        const gematriaCalculators = {
            hebrew: {
                name: "Hebrew Gematria",
                calculate: (word) => {
                    const hebrewValues = {
                        'a': 1, 'b': 2, 'c': 3, 'd': 4, 'e': 5, 'f': 6, 'g': 7, 'h': 8, 'i': 9, 'j': 10,
                        'k': 20, 'l': 30, 'm': 40, 'n': 50, 'o': 60, 'p': 70, 'q': 80, 'r': 90, 's': 100,
                        't': 200, 'u': 300, 'v': 400, 'w': 500, 'x': 600, 'y': 700, 'z': 800
                    };
                    return word.toLowerCase().split('').reduce((sum, char) => sum + (hebrewValues[char] || 0), 0);
                }
            },
            english: {
                name: "English Gematria",
                calculate: (word) => {
                    const englishValues = {
                        'a': 6, 'b': 12, 'c': 18, 'd': 24, 'e': 30, 'f': 36, 'g': 42, 'h': 48, 'i': 54, 'j': 60,
                        'k': 66, 'l': 72, 'm': 78, 'n': 84, 'o': 90, 'p': 96, 'q': 102, 'r': 108, 's': 114,
                        't': 120, 'u': 126, 'v': 132, 'w': 138, 'x': 144, 'y': 150, 'z': 156
                    };
                    return word.toLowerCase().split('').reduce((sum, char) => sum + (englishValues[char] || 0), 0);
                }
            },
            simple: {
                name: "Simple Gematria",
                calculate: (word) => {
                    return word.toLowerCase().split('').reduce((sum, char) => {
                        const code = char.charCodeAt(0);
                        return sum + (code >= 97 && code <= 122 ? code - 96 : 0);
                    }, 0);
                }
            }
        };

        // Gematria word database for transformations
        const gematriaDatabase = {
            hebrew: {
                264: ['acorns', 'wisdom', 'temple', 'garden'],
                156: ['light', 'peace', 'water', 'stone'],
                888: ['jesus', 'christ', 'divine', 'sacred'],
                777: ['perfect', 'heaven', 'spirit', 'crown'],
                666: ['beast', 'number', 'world', 'flesh'],
                318: ['moon', 'silver', 'mirror', 'dream'],
                144: ['time', 'door', 'key', 'path'],
                72: ['god', 'love', 'soul', 'fire'],
                36: ['life', 'tree', 'seed', 'hope'],
                26: ['lord', 'name', 'one', 'unity']
            },
            english: {
                444: ['truth', 'power', 'energy', 'force'],
                666: ['computer', 'internet', 'digital', 'matrix'],
                888: ['abundance', 'infinity', 'eternal', 'cosmos'],
                222: ['balance', 'harmony', 'duality', 'mirror'],
                333: ['trinity', 'creation', 'manifestation', 'magic'],
                555: ['change', 'transformation', 'evolution', 'growth'],
                777: ['perfection', 'completion', 'mastery', 'wisdom'],
                111: ['new beginning', 'awakening', 'enlightenment', 'portal'],
                999: ['ending', 'completion', 'fulfillment', 'achievement']
            },
            simple: {
                74: ['jesus', 'cross', 'lucifer', 'occult'],
                47: ['obey', 'judge', 'government', 'authority'],
                33: ['magic', 'secrecy', 'masonry', 'order'],
                13: ['love', 'kiss', 'bad', 'evil'],
                7: ['god', 'bag', 'cab', 'ace'],
                11: ['die', 'lie', 'elf', 'fake'],
                22: ['v', 'w', 'death', 'kill'],
                44: ['kill', 'hope', 'medicine', 'cancer'],
                77: ['christ', 'power', 'glory', 'victory']
            }
        };

        // Common objects that might be detected in photos
        const commonObjects = [
            'person', 'car', 'chair', 'table', 'book', 'phone', 'computer', 'tree', 'flower', 'dog', 'cat',
            'house', 'building', 'window', 'door', 'cup', 'bottle', 'plate', 'spoon', 'fork', 'knife',
            'bed', 'pillow', 'lamp', 'clock', 'mirror', 'picture', 'television', 'sofa', 'couch', 'desk',
            'pen', 'paper', 'bag', 'shoe', 'shirt', 'hat', 'glasses', 'watch', 'ring', 'necklace',
            'bicycle', 'motorcycle', 'bus', 'train', 'airplane', 'boat', 'bridge', 'road', 'sign', 'light'
        ];

        let currentCipher = 'hebrew';
        let stream = null;
        let isAnalyzing = false;
        let cameraActive = false;

        // DOM elements
        const video = document.getElementById('videoElement');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const startCameraBtn = document.getElementById('startCamera');
        const captureBtn = document.getElementById('captureBtn');
        const demoBtn = document.getElementById('demoBtn');
        const analysisSection = document.getElementById('analysisSection');
        const analysisContent = document.getElementById('analysisContent');
        const cameraPlaceholder = document.getElementById('cameraPlaceholder');
        const cameraStatus = document.getElementById('cameraStatus');
        const fullscreenCamera = document.getElementById('fullscreenCamera');
        const fullscreenVideo = document.getElementById('fullscreenVideo');
        const captureFullscreen = document.getElementById('captureFullscreen');
        const closeFullscreen = document.getElementById('closeFullscreen');

     
